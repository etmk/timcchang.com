---
title: 'Native Dropdowns On Mobile With A Custom Implementation On Tablets & Desktops'
subtitle: "Using React to build a custom timepicker UI that defaults to native implementation on
mobile"
keywords: ['React Hooks', 'Javascript', 'Web Experiments']
breadcrumbs: ['React Hooks', 'Javascript', 'Experiments']
date: '2019-03-19'
type: 'post'
---

While building a custom dropdown menu earlier today, I came across an interesting
solution for switching between a native dropdown menu while on a mobile device, and a custom
dropdown UI while on anything larger than a tablet.

The mobile experience for dropdowns and menus is quite nice, and the web version, though functional
and gets the job done, can be furthered customized to the look and feel on the app.

In this post I will walk through a process for creating a small set of React Hooks that compose together
to build a timepicker. This timepicker will be able to switch between a custom UI on desktop
and the native web implementation on mobile.

Here's what we will build:

# Image here

We'll be working on the following:

1. Creating the markup (we will be using [emotion](https://emotion.sh/))
2. Implementing a `useDropdown` hook to manage dropdown visibility
3. Creating a custom `Timepicker` component
4. Implementing a `useMedia` hook that always gives our component the current viewport width

Let's get started!

## Creating the markup

Here is the basic JSX structure we will be working with. One thing to note is that in CSS we can not
style pseudo elements for elements that do not have children. For example, an `input` element will
never have children, so their pseudo `::before` and `::after` don't exist. One awesome CSS trick to
hack around that is with the `+` selector for styling the next adjacent element.

So with that in mind, we'll create an `<Input />` component that returns a wrapped `input` element with a `span` tag,
stying the pseudo elements of the `span`.

Next, the `<DropdownContainer />` will be the container that contains the dropdown content (hence
the name üßê). We'll pass props down to this component later on to toggle visibility. For now, it'll
just be styled to be hidden.

```tsx
import React from 'react'
import styled from '@emotion/styled'

export default function Demo() {
  return (
    <Container>
      <Group>
        <Label htmlFor="startTime">
          Start Time
          <Input />
        </Label>
        <DropdownContainer>
          {/* Our Timepicker will go in here later */}
        </DropdownContainer>
      </Group>
      <Group>
        <Label htmlFor="endTime">
          End Time
          <Input />
        </Label>
        <DropdownContainer>
          {/* Our Timepicker will go in here later */}
        </DropdownContainer>
      </Group>
    </Container>
  )
}

const Input = (props: any) => (
  <InputContainer>
    <StyledInput {...props} />
    <span />
  </InputContainer>
)
```

Here is the CSS:

```tsx
// ...

const Container = styled.div`
  --box-shadow: 0 1px 3px rgba(188, 193, 217, 0.22), 0 4px 12px rgba(188, 193, 217, 0.25);
  --padding: 20px;
  --border-radius: 5px;
  --font-small: 0.85rem;
  --font-medium: 1.3rem;
  --font-large: 2rem;
  --color-light: #f1f2f7;
  --ease: cubic-bezier(0.19, 1, 0.22, 1);

  box-shadow: var(--box-shadow);
  padding: var(--padding);
  border-radius: var(--border-radius);
  display: grid;
  grid-gap: var(--padding);
`

const Group = styled.div`
  position: relative;
`

const Label = styled.label`
  display: grid;
  grid-template-columns: 100px 1fr;
  align-items: center;
  cursor: pointer;
`

const DropdownContainer = styled.div`
  position: absolute;
  left: 100px;
  top: 60px;
  z-index: 1;
  transform: scaleX(0);
  opacity: 0;
  pointer-events: none;
  touch-action: none;
`

const InputContainer = styled.div`
  position: relative;
`

const StyledInput = styled.input`
  padding: 15px;
  font-size: var(--font-medium);
  border-radius: var(--border-radius);
  border: none;
  width: 100%;
  outline: none;
  &:focus {
    + span {
      &::after {
        opacity: 1;
      }
    }
  }

  + span {
    &::before,
    &::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      border-radius: var(--border-radius);
    }
    &::before {
      border: 1px solid var(--color-light);
    }

    &::after {
      box-shadow: var(--box-shadow);
      opacity: 0;
      transition: opacity 250ms var(--ease);
    }
  }
`
```

## Implementing a useDropdown Hook

Let's define what props the hook will receive and what it should return.

In a new file, `use-dropdown.tsx`, let's set up the function:

```tsx
import React from 'react'

type DropdownProps = {
  id: string
  value: boolean
}[]

export default function useDropdown({
  initialState,
}: {
  initialState: DropdownProps
}) {
  const getContainerProps = {}
  const getTogglerProps = {}
  const getDropdownProps = {}

  return {
    getContainerProps,
    getTogglerProps,
    getDropdownProps,
  }
}
```

When a user calls `useDropdown()`, they'll need to pass in an `initialState` property, which is an
array of objects with a string `id`, and a boolean `value` for the `id`'s initial visibility.

What they should get back is a set of prop getters:

- `getContainerProps` will be the props they spread to the outer containing container (in our case,
  `<Group />`, as that component is the "container" for a specific dropdown.
- `getTogglerProps` will be the props that they spread to the toggler (in our case, `<Input />`).
  This will attach the proper focus handler to toggle the dropdown.
- `getDropdownProps` will be the props that they spread to the dropdown container (in our case,
  `<DropdownContainer />`).

They'll use it like this:

```tsx
const MyApp = () => {
  const { getContainerProps, getTogglerProps, getDropdownProps } = useDropdown([
    { id: 'startDate', value: false },
    { id: 'endDate', value: false },
  ])

  // return (...)
}
```
